<!DOCTYPE html>
<html>
  <head>
    <style>
      @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap');
      @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');
      @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap');
      
      :root {
        --theme-background: #FFCC00;
        --theme-text: #000000;
        --theme-button: #000000;
        --theme-display: #111111;
        --theme-display-text: #FFFFFF;
        --theme-accent: #FF0000;
        --theme-radius: 4px;
        --transition-speed: 0.3s;
        --font-primary: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        --font-mono: 'JetBrains Mono', monospace;
        --font-pixel: 'Press Start 2P', cursive;
        --space-xxs: 3px;
        --space-xs: 4px;
        --space-sm: 6px;
        --space-md: 10px;
        --space-lg: 16px;
        --space-xl: 22px;
        --player-height: 90px; /* ê°ì†Œëœ í”Œë ˆì´ì–´ ë†’ì´ */
        --mini-scale: 0.7; /* ë” ì‘ì€ ì „ì²´ì ì¸ í¬ê¸° ì¶•ì†Œ ë¹„ìœ¨ */
        --font-xs: 8px;
        --font-sm: 10px;
        --font-md: 12px;
        --font-lg: 14px;
        --radius-sm: 4px;
        --radius-md: 6px;
        --radius-lg: 8px;
        --theme-radius-fixed: 8px;
      }

      body {
        font-family: var(--font-primary);
        margin: 0;
        padding: 0 var(--space-md);
        background-color: var(--theme-background);
        color: var(--theme-text);
        transition: background-color var(--transition-speed) ease;
        -webkit-font-smoothing: antialiased;
        font-size: 14px;
      }
      
      .container {
        display: flex;
        flex-direction: column;
        gap: var(--space-xs);
        width: 100%;
        max-width: 280px;
        margin: 0 auto;
        padding: var(--space-xs) 0 var(--space-md) 0; /* Add more padding at bottom */
      }

      .header {
        display: none;
      }

      .logo {
        font-weight: 600;
        font-size: 10px;
        letter-spacing: 1px;
        color: var(--theme-text);
        transition: color var(--transition-speed) ease;
      }

      .theme-selector {
        margin-bottom: var(--space-sm);
      }

      .theme-selector select {
        width: 100%;
        padding: var(--space-xs) var(--space-sm);
        background-color: transparent;
        color: var(--theme-text);
        font-size: 12px;
        transition: all var(--transition-speed) ease;
        border: 1px solid rgba(0, 0, 0, 0.2);
        border-radius: var(--theme-radius-fixed);
        appearance: none;
        background-image: url("data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E");
        background-repeat: no-repeat;
        background-position: right 8px top 50%;
        background-size: 8px auto;
        padding-right: 20px;
      }
      
      .theme-selector select:focus {
        outline: none;
        box-shadow: 0 0 0 1px var(--theme-accent);
      }

      .playlist-title {
        font-size: 11px;
        font-weight: 500;
        color: var(--theme-text);
        opacity: 0.8;
        margin-bottom: var(--space-xs);
        display: block;
      }

      .track-list {
        display: flex;
        flex-direction: column;
        gap: 3px;
        border: 1px solid rgba(0, 0, 0, 0.2);
        border-radius: var(--theme-radius-fixed);
        padding: var(--space-sm);
        background-color: rgba(255, 255, 255, 0.05);
        transition: border-radius var(--transition-speed) ease, 
                   border-color var(--transition-speed) ease;
        margin-bottom: var(--space-sm);
      }

      .track-item {
        display: flex;
        align-items: center;
        padding: var(--space-xs) var(--space-sm);
        border-radius: var(--theme-radius);
        cursor: pointer;
        transition: background-color 0.2s, border-radius var(--transition-speed) ease;
        position: relative;
        overflow: hidden;
        min-height: 38px; /* Slightly reduced height */
        box-sizing: border-box;
      }

      .track-item:hover {
        background-color: rgba(0, 0, 0, 0.07);
      }

      .track-item.selected {
        background-color: var(--theme-button);
        color: #FFFFFF;
      }
      
      .track-item.selected::before {
        content: '';
        position: absolute;
        left: 0;
        top: 0;
        height: 100%;
        width: 2px;
        background-color: var(--theme-accent);
      }

      .track-info {
        flex: 1;
        padding: var(--space-xxs) 0;
      }

      .track-title {
        font-weight: 600;
        font-size: 12px;
        margin-bottom: 3px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      .track-artist {
        font-size: 10px;
        opacity: 0.7;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      .preview-player {
        border-radius: var(--theme-radius);
        margin-bottom: var(--space-sm);
        transition: border-radius var(--transition-speed) ease;
        overflow: hidden;
        width: 100%;
      }

      .preview-display {
        background-color: var(--theme-display);
        border-radius: var(--theme-radius-fixed) !important;
        padding: var(--space-sm) var(--space-md);
        color: var(--theme-display-text);
        transition: all var(--transition-speed) ease;
        border: 1px solid rgba(0, 0, 0, 0.1);
      }
      
      /* iPod Classic specific styles - update to monochrome */
      .ipod-classic .preview-display {
        font-family: var(--font-mono);
        font-size: 10px;
        filter: grayscale(100%); /* Force grayscale on the display */
      }
      
      .ipod-classic .track-title, 
      .ipod-classic .preview-title {
        font-family: var(--font-mono);
      }
      
      .ipod-classic .now-playing span,
      .ipod-classic .preview-artist {
        font-family: var(--font-mono);
        letter-spacing: -0.5px;
      }
      
      .ipod-classic .status-dot {
        background-color: #666666 !important; /* Force gray status dot */
      }
      
      .ipod-classic .status-dot.playing {
        background-color: #333333 !important; /* Darker gray when playing */
        box-shadow: 0 0 3px #333333 !important;
      }
      
      .ipod-classic .progress-bar {
        background-color: #666666 !important; /* Gray progress bar */
      }
      
      /* Vapor Wave specific styles */
      .vapor-wave .preview-display {
        font-family: var(--font-pixel);
        font-size: 8px;
      }
      
      /* ë¯¸ë‹ˆë©€ í”Œë ˆì´ì–´ ìŠ¤íƒ€ì¼ (ì•¨ë²”ì•„íŠ¸ ì—†ìŒ) */
      .minimal-player .preview-display {
        font-family: var(--font-primary);
        font-size: 11px;
        padding: var(--space-xs) var(--space-sm);
      }
      
      /* ë¯¸ë‹ˆë©€ í”Œë ˆì´ì–´ì—ì„œëŠ” ë” ê°„ê²°í•œ UI í‘œì‹œ */
      .minimal-player .preview-title {
        font-weight: 500;
        text-transform: none;
      }
      
      .minimal-player .preview-artist {
        text-transform: none;
      }
      
      /* ë¯¸ë‹ˆë©€ í”Œë ˆì´ì–´ ì „ìš© ìŠ¤íƒ€ì¼ (ì•¨ë²”ì•„íŠ¸ ìˆ¨ê¹€) */
      .minimal-player .preview-iframe {
        height: 45px;
        background-color: var(--theme-button);
        opacity: 0.9;
      }
      
      /* í”Œë ˆì´ì–´ iframe ìŠ¤íƒ€ì¼ í†µì¼ */
      .preview-iframe {
        width: 100%;
        height: 80px;
        border: none;
        margin-top: var(--space-xxs);
        border-radius: var(--theme-radius);
        transition: border-radius var(--transition-speed) ease;
      }
      
      .now-playing {
        display: block;
        position: relative;
        height: 20px;
        margin-bottom: var(--space-sm);
        text-align: left;
      }
      
      .now-playing span {
        position: absolute;
        left: 0;
        font-size: 10px;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }
      
      .status-dot {
        position: absolute;
        right: 0;
        top: 7px;
        width: 6px;
        height: 6px;
        border-radius: 50%;
        background-color: red;
        transition: background-color 0.6s ease;
      }

      .status-dot.playing {
        background-color: #00ff85;
        box-shadow: 0 0 3px #00ff85;
      }
      
      .preview-title {
        font-size: 13px;
        font-weight: bold;
        margin-top: 8px;
        margin-bottom: 3px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      .preview-artist {
        font-size: 11px;
        opacity: 0.8;
        margin-bottom: var(--space-xs);
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      .footer {
        margin-top: 0;
        text-align: center;
        font-size: 8px;
        color: var(--theme-text);
        opacity: 0.6;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      #debug-version {
        background: rgba(0, 0, 0, 0.1);
        color: var(--theme-text);
        padding: var(--space-sm) var(--space-md); 
        margin-bottom: var(--space-sm); 
        font-size: 11px;
        font-weight: 500; 
        text-align: center;
        border-radius: var(--theme-radius-fixed) !important;
        letter-spacing: 0.5px;
        border: 1px solid rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(8px);
        -webkit-backdrop-filter: blur(8px);
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      }
      
      /* íŠ¸ë™ í•­ëª© ë¡œë”© ì• ë‹ˆë©”ì´ì…˜ */
      @keyframes trackItemFadeIn {
        from { opacity: 0; transform: translateY(3px); }
        to { opacity: 1; transform: translateY(0); }
      }
      
      .track-item {
        animation: trackItemFadeIn 0.3s ease forwards;
      }
      
      .track-item:nth-child(1) { animation-delay: 0.05s; }
      .track-item:nth-child(2) { animation-delay: 0.1s; }
      .track-item:nth-child(3) { animation-delay: 0.15s; }

      /* í…Œë§ˆ ì „í™˜ ì¤‘ ì• ë‹ˆë©”ì´ì…˜ */
      body.theme-transition {
        transition: background-color 0.3s ease;
      }
      
      body.theme-transition * {
        transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
      }
      
      /* í† ìŠ¤íŠ¸ ë©”ì‹œì§€ ìŠ¤íƒ€ì¼ */
      #plugin-toast {
        position: fixed;
        bottom: 15px;
        left: 50%;
        transform: translateX(-50%);
        background-color: rgba(0, 0, 0, 0.7);
        color: white;
        padding: 5px 16px;
        border-radius: var(--theme-radius-fixed);
        font-size: 9px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        z-index: 100;
        opacity: 0;
        min-width: 156px;
        max-width: 90%;
        text-align: center;
        backdrop-filter: blur(4px);
        -webkit-backdrop-filter: blur(4px);
        transition: opacity 0.3s ease;
      }
      
      /* Track item loading animation and style adjustment */
      .track-item.loading {
        position: relative;
        opacity: 0.7;
      }
      
      .track-item.loading small {
        display: block;
        font-size: 10px;
        padding: 7px var(--space-sm); /* Reduced vertical padding */
        margin: 0;
        opacity: 0.8;
        line-height: 1.1;
      }
      
      .track-item.loading:after {
        content: '';
        position: absolute;
        width: 100%;
        height: 1px;
        bottom: 0;
        left: 0;
        background: linear-gradient(90deg, transparent, var(--theme-accent), transparent);
        animation: loadingSlide 1.5s infinite;
      }
      
      @keyframes loadingSlide {
        0% { transform: translateX(-100%); }
        100% { transform: translateX(100%); }
      }

      /* ì‘ì€ í™”ë©´ì—ì„œ ì—¬ë°± ì¡°ì • */
      @media (max-width: 340px) {
        body {
          padding: var(--space-xs) var(--space-xs);
        }
        
        .preview-display {
          padding: var(--space-sm) var(--space-sm);
        }
      }

      .player-card {
        border-radius: var(--radius-lg);
        overflow: hidden;
        transition: all 0.2s ease;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }
      
      .sc-player {
        padding: var(--space-sm);
        display: grid;
        grid-template-columns: 40px 1fr;
        grid-gap: var(--space-sm);
      }
      
      .sc-player .album-art {
        width: 40px;
        height: 40px;
        border-radius: var(--radius-sm);
        overflow: hidden;
      }
      
      .sc-player .controls {
        display: flex;
        gap: var(--space-xs);
        margin-top: var(--space-xs);
      }
      
      .sc-player .controls button {
        padding: var(--space-xs);
        border-radius: var(--radius-sm);
        width: 22px;
        height: 22px;
      }
      
      .sc-player .track-info {
        font-size: var(--font-sm);
        margin-bottom: var(--space-xs);
      }
      
      .sc-player .artist {
        font-size: var(--font-xs);
        opacity: 0.8;
      }

      /* New player layout with album art */
      .player-content {
        display: flex;
        align-items: center;
        gap: var(--space-sm);
        margin-bottom: var(--space-sm);
      }
      
      .album-art-mini {
        width: 30px;
        height: 30px;
        border-radius: 4px;
        background-color: rgba(0, 0, 0, 0.2);
        overflow: hidden;
        position: relative;
      }
      
      .album-art-mini img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }
      
      .track-info-mini {
        flex: 1;
        overflow: hidden;
      }
      
      .now-playing {
        display: flex;
        justify-content: flex-end;
        align-items: center;
        margin-bottom: var(--space-xxs);
      }
      
      .preview-display {
        background-color: var(--theme-display);
        border-radius: var(--theme-radius-fixed) !important;
        padding: var(--space-sm) var(--space-md);
        color: var(--theme-display-text);
        transition: all var(--transition-speed) ease;
        border: 1px solid rgba(0, 0, 0, 0.1);
      }
      
      /* Update figma plugin size */
      @media (max-width: 280px) {
        body {
          padding: 0;
          overflow-x: hidden;
        }
        
        .container {
          max-width: 100%;
          padding: var(--space-xxs);
        }
      }

      /* Fix duplicate styling and add margin */
      .now-playing-container {
        background-color: rgba(0, 0, 0, 0.1);
        border-radius: var(--theme-radius-fixed) !important;
        padding: var(--space-md);
        margin: var(--space-sm) 0 5px 0;
        position: relative;
        border: none;
      }
      
      /* Fix the play button border radius */
      .play-button {
        width: 36px;
        height: 36px;
        border-radius: 50%;
        background-color: var(--theme-button);
        display: flex;
        align-items: center;
        justify-content: center;
        border: none;
        cursor: pointer;
        color: #fff;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.15);
        transition: all 0.2s ease;
      }
      
      .play-button:hover {
        transform: scale(1.05);
        box-shadow: 0 3px 8px rgba(0, 0, 0, 0.2);
      }
      
      .play-button svg {
        width: 16px;
        height: 16px;
        fill: currentColor;
      }
      
      .player-controls {
        display: flex;
        align-items: center;
        justify-content: flex-start;
        margin-top: var(--space-sm);
        padding-left: 0;
        gap: var(--space-md);
      }
      
      .progress-container {
        flex: 1;
        height: 5px;
        background-color: rgba(255, 255, 255, 0.2);
        border-radius: 2px;
        overflow: hidden;
        position: relative;
        cursor: pointer;
      }
      
      .progress-bar {
        position: absolute;
        left: 0;
        top: 0;
        height: 100%;
        background-color: var(--theme-accent);
        width: 30%;
      }
      
      .time-display {
        font-size: 10px;
        opacity: 0.7;
      }

      /* Remove any leftover album-art-mini and player-content styles */
      .album-art-mini, .player-content {
        display: none;
      }
      
      /* Adjust theme selector spacing */
      .theme-selector {
        margin-bottom: var(--space-sm);
      }
      
      .theme-selector select {
        width: 100%;
        padding: var(--space-xs) var(--space-sm);
        background-color: transparent;
        color: var(--theme-text);
        font-size: 12px;
        transition: all var(--transition-speed) ease;
        border: 1px solid rgba(0, 0, 0, 0.2);
        border-radius: var(--theme-radius-fixed);
        appearance: none;
        background-image: url("data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E");
        background-repeat: no-repeat;
        background-position: right 8px top 50%;
        background-size: 8px auto;
        padding-right: 20px;
      }
      
      /* Debug version style */
      #debug-version {
        background: var(--theme-accent); 
        color: white; 
        padding: var(--space-xxs) var(--space-xs); 
        margin-bottom: var(--space-sm); 
        font-size: 10px; 
        text-align: center;
        border-radius: var(--theme-radius-fixed);
      }

      /* Ensure consistent UI size by giving preview container a min-height */
      #preview-container {
        min-height: 185px;
      }
      
      /* Initially show preview container with placeholder */
      #preview-container.empty {
        display: block !important;
        opacity: 0.5;
      }
      
      /* Reset the now-playing styles completely */
      .now-playing {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: var(--space-sm);
        width: 100%;
      }
      
      .now-playing span {
        font-size: 10px;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }
      
      .now-playing .status-dot {
        position: absolute;
        right: 0;
      }

      /* Fix NOW PLAYING text alignment */
      .preview-display .now-playing {
        text-align: left;
      }

      /* Loading text style */
      .track-item.loading {
        font-size: 10px;
        opacity: 0.7;
      }
      
      /* Loading animation */
      @keyframes loadingSlide {
        0% { transform: translateX(-100%); }
        100% { transform: translateX(100%); }
      }
      
      /* Loading style with smaller font */
      .track-item.loading:after {
        content: '';
        position: absolute;
        width: 100%;
        height: 1px;
        bottom: 0;
        left: 0;
        background: linear-gradient(90deg, transparent, var(--theme-accent), transparent);
        animation: loadingSlide 1.5s infinite;
      }

      /* Override theme radius with fixed value */
      .track-list,
      .theme-selector select,
      .preview-display,
      .now-playing-container,
      #debug-version,
      #plugin-toast {
        border-radius: var(--theme-radius-fixed) !important;
        transition: background-color var(--transition-speed) ease, 
                   color var(--transition-speed) ease;
      }
      
      /* Maintain consistent stroke */
      .track-list {
        border: 1px solid rgba(0, 0, 0, 0.2);
      }
      
      .theme-selector select {
        border: 1px solid rgba(0, 0, 0, 0.2);
      }
    </style>
    <script>
      // ì „ì—­ ìƒíƒœ ê°ì²´ ì´ˆê¸°í™”
      window._savedSCPlayerState = {
        position: 0,
        isPlaying: false
      };
      
      // ë””ë²„ê¹… í•¨ìˆ˜
      window.debugFigmaPlugin = {
        logDom: function() {
          console.log('DOM ìš”ì†Œ ê²€ì‚¬:');
          const elements = {
            'track-list': document.getElementById('track-list'),
            'theme-select': document.getElementById('theme-select'),
            'sc-iframe': document.getElementById('sc-iframe'),
            'preview-container': document.getElementById('preview-container'),
            'preview-title': document.getElementById('preview-title'),
            'preview-artist': document.getElementById('preview-artist'),
            'status-dot': document.getElementById('status-dot'),
            'play-icon': document.getElementById('play-icon'),
            'pause-icon': document.getElementById('pause-icon'),
            'play-pause-btn': document.getElementById('play-pause-btn'),
            'insert-button': document.getElementById('insert-button')
          };
          
          for (const [id, element] of Object.entries(elements)) {
            console.log(`${id}: ${element ? 'ì¡´ì¬í•¨' : 'ì¡´ì¬í•˜ì§€ ì•ŠìŒ'}`);
          }
          return elements;
        },
        
        // í…Œë§ˆ í™•ì¸ ë° ìƒì„±
        checkThemes: function() {
          // í•˜ë“œì½”ë”©ëœ í…Œë§ˆ ë°ì´í„°
          const themes = [
            {
              id: "framer-minimal",
              name: "Modern (Default)",
              styles: {
                backgroundColor: "#FFFFFF",
                textColor: "#000000",
                buttonColor: "#0099FF",
                displayColor: "#F5F5F5",
                displayTextColor: "#000000",
                accentColor: "#0099FF",
                borderRadius: "12px"
              }
            },
            {
              id: "framer-dark",
              name: "Modern (Dark)",
              styles: {
                backgroundColor: "#1E1E1E", 
                textColor: "#FFFFFF",
                buttonColor: "#0099FF",
                displayColor: "#2D2D2D",
                displayTextColor: "#FFFFFF",
                accentColor: "#0099FF",
                borderRadius: "12px"
              }
            },
            {
              id: "te-op1",
              name: "TE OP-1",
              styles: {
                backgroundColor: "#FFCC00",
                textColor: "#000000",
                buttonColor: "#000000",
                displayColor: "#111111",
                displayTextColor: "#FFFFFF",
                accentColor: "#FF0000",
                borderRadius: "4px"
              }
            },
            {
              id: "te-op1-dark",
              name: "TE OP-1 Dark",
              styles: {
                backgroundColor: "#222222",
                textColor: "#FFFFFF",
                buttonColor: "#FFCC00",
                displayColor: "#000000",
                displayTextColor: "#FFCC00",
                accentColor: "#FFCC00",
                borderRadius: "4px"
              }
            },
            {
              id: "neo-mint",
              name: "Neo Mint",
              styles: {
                backgroundColor: "#BDEED0",
                textColor: "#2A3B47",
                buttonColor: "#0CC0DF",
                displayColor: "#FFFFFF",
                displayTextColor: "#2A3B47",
                accentColor: "#FF6B95",
                borderRadius: "16px"
              }
            },
            {
              id: "vapor-wave",
              name: "Vapor Wave",
              styles: {
                backgroundColor: "#131377",
                textColor: "#FFFFFF",
                buttonColor: "#FF00FF",
                displayColor: "#000000",
                displayTextColor: "#00FFFF",
                accentColor: "#FF00FF",
                borderRadius: "0px"
              }
            },
            {
              id: "ipod-classic",
              name: "iPod Classic",
              styles: {
                backgroundColor: "#ECECEC", // iPod silver body
                textColor: "#000000",
                buttonColor: "#6A6A6A", // Silver button
                displayColor: "#D6DCE4", // Light blue-gray display
                displayTextColor: "#000000",
                accentColor: "#666666", // Changed from Apple blue to dark gray
                borderRadius: "8px"
              }
            }
          ];
          
          // í…Œë§ˆ ì˜µì…˜ ì§ì ‘ ì±„ìš°ê¸°
          const themeSelect = document.getElementById('theme-select');
          if (themeSelect) {
            console.log('í…Œë§ˆ ì„ íƒê¸°ì— ì˜µì…˜ ì¶”ê°€ ì¤‘...');
            
            // ê¸°ì¡´ ì˜µì…˜ ì œê±°
            themeSelect.innerHTML = '';
            
            // ì˜µì…˜ ì¶”ê°€
            themes.forEach(theme => {
              const option = document.createElement('option');
              option.value = theme.id;
              option.textContent = theme.name;
              themeSelect.appendChild(option);
              console.log(`í…Œë§ˆ ì˜µì…˜ ì¶”ê°€ë¨: ${theme.name}`);
            });
            
            return true;
          } else {
            console.error('í…Œë§ˆ ì„ íƒ ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ');
            return false;
          }
        },
        
        // í…Œë§ˆ ì§ì ‘ ì ìš© (ì™„ì „íˆ ì¬ì‘ì„±ëœ ë²„ì „)
        applyTheme: function(themeId) {
          const themes = this.getThemes();
          const theme = themes.find(t => t.id === themeId) || themes[2]; // ê¸°ë³¸ê°’ TE OP-1
          
          console.log(`í…Œë§ˆ ì§ì ‘ ì ìš©: ${theme.name}`);
          
          // í…Œë§ˆ ì „í™˜ ì• ë‹ˆë©”ì´ì…˜
          document.body.classList.add('theme-transition');
          
          // ì´ì „ í…Œë§ˆ í´ë˜ìŠ¤ ì œê±°
          document.body.classList.remove('ipod-classic', 'vapor-wave', 'minimal-player');
          
          // íŠ¹ì • í…Œë§ˆ í´ë˜ìŠ¤ ì¶”ê°€
          if (theme.id === 'ipod-classic') {
            document.body.classList.add('ipod-classic');
          } else if (theme.id === 'vapor-wave') {
            document.body.classList.add('vapor-wave');
          }
          
          // CSS ë³€ìˆ˜ ì„¤ì • - border-radiusëŠ” ì—…ë°ì´íŠ¸í•˜ì§€ ì•ŠìŒ
          const root = document.documentElement;
          const { styles } = theme;
          
          root.style.setProperty('--theme-background', styles.backgroundColor);
          root.style.setProperty('--theme-text', styles.textColor);
          root.style.setProperty('--theme-button', styles.buttonColor);
          root.style.setProperty('--theme-display', styles.displayColor);
          root.style.setProperty('--theme-display-text', styles.displayTextColor);
          root.style.setProperty('--theme-accent', styles.accentColor);
          // border-radiusëŠ” ê³ ì •ê°’ ì‚¬ìš©
          
          // IFRAME ì—…ë°ì´íŠ¸ - ìƒˆë¡œìš´ ì ‘ê·¼ ë°©ì‹
          // ê¸°ì¡´ iframeì„ ìœ ì§€í•˜ê³  SoundCloud ìƒ‰ìƒ ë§¤ê°œë³€ìˆ˜ë§Œ ë³€ê²½í•©ë‹ˆë‹¤
          const scIframe = document.getElementById('sc-iframe');
          if (scIframe && scIframe.src && scIframe.src.includes('soundcloud.com')) {
            try {
              // í˜„ì¬ iframe ì†ŒìŠ¤ì—ì„œ ìƒ‰ìƒë§Œ ë³€ê²½
              const currentUrl = scIframe.src;
              const newColor = styles.accentColor.replace('#', '');
              
              // 1. CSSë¡œ ìƒ‰ìƒ ë³€ê²½ - iframeì€ ê·¸ëŒ€ë¡œ ìœ ì§€
              const iframeContainer = scIframe.parentElement;
              if (iframeContainer) {
                iframeContainer.style.borderColor = styles.accentColor;
              }
              
              // ì•Œë¦¼ í‘œì‹œ
              this.showToast(`ğŸ¨ ${theme.name}`);
              
              // ìš°ë¦¬ê°€ SoundCloud APIë¡œ ì•¡ì„¸ìŠ¤í•  í•„ìš” ì—†ì´
              // 2. ê¸°ì¡´ iframe ìœ ì§€ (êµì²´í•˜ì§€ ì•ŠìŒ)
              // ì´ë ‡ê²Œ í•˜ë©´ ì¬ìƒ ìœ„ì¹˜ê°€ ì €ì ˆë¡œ ìœ ì§€ë¨
              
              console.log('í…Œë§ˆ ì ìš© ì™„ë£Œ - iframe ì¬ìƒ ìƒíƒœ ìœ ì§€ë¨');
            } catch (error) {
              console.error('í…Œë§ˆ ì ìš© ì¤‘ ì˜¤ë¥˜:', error);
            }
          } else {
            console.log('ì¬ìƒ ì¤‘ì¸ SoundCloud iframeì´ ì—†ìŒ');
          }
          
          // í…Œë§ˆ ì „í™˜ ì• ë‹ˆë©”ì´ì…˜ ì œê±°
          setTimeout(() => {
            document.body.classList.remove('theme-transition');
          }, 300);
        },
        
        // í† ìŠ¤íŠ¸ ë©”ì‹œì§€ í‘œì‹œ
        showToast: function(message, duration = 1500) {
          try {
            // ê¸°ì¡´ í† ìŠ¤íŠ¸ ì œê±°
            const existingToast = document.getElementById('plugin-toast');
            if (existingToast) {
              existingToast.remove();
            }
            
            // ìƒˆ í† ìŠ¤íŠ¸ ìƒì„±
            const toast = document.createElement('div');
            toast.id = 'plugin-toast';
            toast.textContent = message;
            document.body.appendChild(toast);
            
            // í† ìŠ¤íŠ¸ í‘œì‹œ
            setTimeout(() => {
              toast.style.opacity = '0.9';
            }, 10);
            
            // ìë™ ì œê±°
            setTimeout(() => {
              toast.style.opacity = '0';
              setTimeout(() => {
                toast.remove();
              }, 300);
            }, duration);
          } catch (error) {
            console.error('í† ìŠ¤íŠ¸ í‘œì‹œ ì¤‘ ì˜¤ë¥˜:', error);
          }
        },
        
        // íŠ¸ë™ ì„ íƒ ì‹œ í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜ë¥¼ ìƒì„±í•©ë‹ˆë‹¤
        createTrackSelector: function(track, trackItem) {
          return function() {
            console.log(`íŠ¸ë™ ì„ íƒë¨: ${track.title}`);
            
            // Get exact dimensions before any changes
            const rect = trackItem.getBoundingClientRect();
            const exactHeight = rect.height;
            
            // Clone track item content for later restoration
            const clone = trackItem.cloneNode(true);
            
            // ë¡œë”© í‘œì‹œ - simplified to reduce height variation
            trackItem.classList.add('loading');
            trackItem.style.height = exactHeight + 'px';
            trackItem.innerHTML = '<small>Loading...</small>';
            
            // ì„ íƒ ìŠ¤íƒ€ì¼ ì ìš©
            document.querySelectorAll('.track-item').forEach(item => {
              item.classList.remove('selected');
            });
            trackItem.classList.add('selected');
            
            // í˜„ì¬ ì„ íƒëœ í…Œë§ˆ ìƒ‰ìƒ ê°€ì ¸ì˜¤ê¸°
            const themeSelect = document.getElementById('theme-select');
            const selectedThemeId = themeSelect ? themeSelect.value : 'te-op1';
            const themes = window.debugFigmaPlugin.getThemes();
            const selectedTheme = themes.find(t => t.id === selectedThemeId) || themes[2]; // ê¸°ë³¸ê°’ TE OP-1
            const accentColor = selectedTheme.styles.accentColor.replace('#', '');
            
            // ë¯¸ë¦¬ë³´ê¸° í‘œì‹œ
            const previewContainer = document.getElementById('preview-container');
            const previewTitle = document.getElementById('preview-title');
            const previewArtist = document.getElementById('preview-artist');
            const scIframe = document.getElementById('sc-iframe');
            
            if (previewContainer && previewTitle && previewArtist) {
              // Remove empty class
              previewContainer.classList.remove('empty');
              
              previewContainer.style.display = 'block';
              previewTitle.textContent = track.title;
              previewArtist.textContent = track.artist;
              
              // SoundCloud iframe ì„¤ì • ë° ì¬ìƒ
              if (scIframe) {
                // iframe ì†ŒìŠ¤ ì„¤ì • - ì•¨ë²”ì•„íŠ¸ í‘œì‹œ ìµœì†Œí™”ë¥¼ ìœ„í•´ visual=falseë¡œ ê³ ì •
                const iframeSrc = `https://w.soundcloud.com/player/?url=${encodeURIComponent(track.url)}&color=${accentColor}&auto_play=true&hide_related=true&show_comments=false&show_user=true&show_reposts=false&show_teaser=false&visual=false`;
                scIframe.src = iframeSrc;
                console.log('SoundCloud iframe ì†ŒìŠ¤ ì„¤ì •:', iframeSrc);
                
                // SoundCloud Widget API ì´ˆê¸°í™”
                setTimeout(() => {
                  window.debugFigmaPlugin.initPlayer(scIframe);
                  
                  // ë¡œë”© ì™„ë£Œ, ì›ë˜ ì½˜í…ì¸  ë³µì›
                  trackItem.classList.remove('loading');
                  trackItem.style.height = '';
                  trackItem.style.width = '';
                  
                  // Restore from the clone
                  trackItem.innerHTML = clone.innerHTML;
                  
                  // í† ìŠ¤íŠ¸ ë©”ì‹œì§€ í‘œì‹œ - ê°„ê²°í•˜ê²Œ ë³€ê²½
                  window.debugFigmaPlugin.showToast(`â–¶ ${track.title}`);
                }, 1000);
              }
            }
          };
        },
        
        // íŠ¸ë™ ëª©ë¡ ì´ˆê¸°í™”
        createTracks: function() {
          // í•˜ë“œì½”ë”©ëœ íŠ¸ë™ ë°ì´í„°
          const tracks = [
            {
              title: "OP-1 Field Ambient Session",
              artist: "Red Means Recording",
              url: "https://soundcloud.com/soundsgood_store/monday-mix-sgmm119-lovefool"
            },
            {
              title: "TX-6 + OP-1 Field Jam",
              artist: "HAINBACH",
              url: "https://soundcloud.com/euna34everywhere/sunshower"
            },
            {
              title: "EP-133 First Impressions", 
              artist: "Red Means Recording",
              url: "https://soundcloud.com/user-190687460/sunday"
            }
          ];
          
          // íŠ¸ë™ ëª©ë¡ì— íŠ¸ë™ ì¶”ê°€
          const trackList = document.getElementById('track-list');
          if (trackList) {
            console.log('íŠ¸ë™ ëª©ë¡ì— íŠ¸ë™ ì¶”ê°€ ì¤‘...');
            
            // ê¸°ì¡´ í•­ëª© ì œê±°
            trackList.innerHTML = '';
            
            // íŠ¸ë™ ì¶”ê°€
            tracks.forEach((track, index) => {
              const trackItem = document.createElement('div');
              trackItem.className = 'track-item';
              trackItem.id = `track-${index}`;
              trackItem.style.animationDelay = `${index * 0.05}s`;
              
              trackItem.innerHTML = `
                <div class="track-info">
                  <div class="track-title">${track.title}</div>
                  <div class="track-artist">${track.artist}</div>
                </div>
              `;
              
              // í´ë¦­ ì´ë²¤íŠ¸ ì¶”ê°€ - ê°œì„ ëœ ë°©ì‹ìœ¼ë¡œ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ìƒì„±
              trackItem.addEventListener('click', this.createTrackSelector(track, trackItem));
              
              trackList.appendChild(trackItem);
              console.log(`íŠ¸ë™ ì¶”ê°€ë¨: ${track.title}`);
            });
            
            return true;
          } else {
            console.error('íŠ¸ë™ ëª©ë¡ ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ');
            return false;
          }
        },
        
        // í…Œë§ˆ ë°ì´í„° ë°˜í™˜
        getThemes: function() {
          return [
            {
              id: "framer-minimal",
              name: "Modern (Default)",
              styles: {
                backgroundColor: "#FFFFFF",
                textColor: "#000000",
                buttonColor: "#0099FF",
                displayColor: "#F5F5F5",
                displayTextColor: "#000000",
                accentColor: "#0099FF",
                borderRadius: "12px"
              }
            },
            {
              id: "framer-dark",
              name: "Modern (Dark)",
              styles: {
                backgroundColor: "#1E1E1E", 
                textColor: "#FFFFFF",
                buttonColor: "#0099FF",
                displayColor: "#2D2D2D",
                displayTextColor: "#FFFFFF",
                accentColor: "#0099FF",
                borderRadius: "12px"
              }
            },
            {
              id: "te-op1",
              name: "TE OP-1",
              styles: {
                backgroundColor: "#FFCC00",
                textColor: "#000000",
                buttonColor: "#000000",
                displayColor: "#111111",
                displayTextColor: "#FFFFFF",
                accentColor: "#FF0000",
                borderRadius: "4px"
              }
            },
            {
              id: "te-op1-dark",
              name: "TE OP-1 Dark",
              styles: {
                backgroundColor: "#222222",
                textColor: "#FFFFFF",
                buttonColor: "#FFCC00",
                displayColor: "#000000",
                displayTextColor: "#FFCC00",
                accentColor: "#FFCC00",
                borderRadius: "4px"
              }
            },
            {
              id: "neo-mint",
              name: "Neo Mint",
              styles: {
                backgroundColor: "#BDEED0",
                textColor: "#2A3B47",
                buttonColor: "#0CC0DF",
                displayColor: "#FFFFFF",
                displayTextColor: "#2A3B47",
                accentColor: "#FF6B95",
                borderRadius: "16px"
              }
            },
            {
              id: "vapor-wave",
              name: "Vapor Wave",
              styles: {
                backgroundColor: "#131377",
                textColor: "#FFFFFF",
                buttonColor: "#FF00FF",
                displayColor: "#000000",
                displayTextColor: "#00FFFF",
                accentColor: "#FF00FF",
                borderRadius: "0px"
              }
            },
            {
              id: "ipod-classic",
              name: "iPod Classic",
              styles: {
                backgroundColor: "#ECECEC", // iPod silver body
                textColor: "#000000",
                buttonColor: "#6A6A6A", // Silver button
                displayColor: "#D6DCE4", // Light blue-gray display
                displayTextColor: "#000000",
                accentColor: "#666666", // Changed from Apple blue to dark gray
                borderRadius: "8px"
              }
            }
          ];
        },
        
        // SoundCloud API ë¡œë“œ
        loadSoundCloudAPI: function(callback) {
          if (window.SC && window.SC.Widget) {
            console.log('SoundCloud APIê°€ ì´ë¯¸ ë¡œë“œë¨');
            if (callback) callback();
            return;
          }
          
          console.log('SoundCloud API ë¡œë“œ ì¤‘...');
          const script = document.createElement('script');
          script.src = 'https://w.soundcloud.com/player/api.js';
          script.onload = function() {
            console.log('SoundCloud API ë¡œë“œ ì™„ë£Œ');
            if (callback) callback();
          };
          script.onerror = function(e) {
            console.error('SoundCloud API ë¡œë“œ ì‹¤íŒ¨:', e);
          };
          document.head.appendChild(script);
        },
        
        // SoundCloud í”Œë ˆì´ì–´ ì´ˆê¸°í™”
        initPlayer: function(iframe) {
          if (!window.SC || !window.SC.Widget) {
            console.warn('SoundCloud APIê°€ ë¡œë“œë˜ì§€ ì•Šì•˜ìŒ');
            this.loadSoundCloudAPI(() => this.initPlayer(iframe));
            return;
          }
          
          try {
            const widget = window.SC.Widget(iframe);
            console.log('SoundCloud ìœ„ì ¯ ìƒì„±ë¨');
            
            // UI ìš”ì†Œ
            const statusDot = document.getElementById('status-dot');
            const playButton = document.getElementById('player-play-btn');
            const progressBar = document.getElementById('progress-bar');
            const timeDisplay = document.getElementById('time-display');
            
            // í•„ìˆ˜: ê¸°ì¡´ ë°”ì¸ë”© ì œê±°
            if (this.widget) {
              this.widget.unbind(window.SC.Widget.Events.PLAY);
              this.widget.unbind(window.SC.Widget.Events.PAUSE);
              this.widget.unbind(window.SC.Widget.Events.FINISH);
              this.widget.unbind(window.SC.Widget.Events.READY);
              
              // ê¸°ì¡´ íƒ€ì´ë¨¸ ì‚­ì œ
              if (this.positionInterval) {
                clearInterval(this.positionInterval);
                this.positionInterval = null;
              }
            }
            
            // ìœ„ì ¯ ì €ì¥
            this.widget = widget;
            
            // ì‹œê°„ í¬ë§· í•¨ìˆ˜
            function formatTime(ms) {
              const totalSeconds = Math.floor(ms / 1000);
              const minutes = Math.floor(totalSeconds / 60);
              const seconds = totalSeconds % 60;
              return `${minutes}:${seconds < 10 ? '0' + seconds : seconds}`;
            }
            
            // í”Œë ˆì´ì–´ ìƒíƒœ ë³€ìˆ˜ ì €ì¥ (ì „ì—­ìœ¼ë¡œ ë³€ê²½)
            window._playerState = {
              isPlaying: false,
              currentPosition: 0,
              duration: 0
            };
            
            const playerState = window._playerState;
            
            // í”Œë ˆì´ ë²„íŠ¼ ì™„ì „íˆ ìƒˆë¡œ í• ë‹¹ ë° í´ë¦­ ì´ë²¤íŠ¸ ì¶”ê°€
            if (playButton) {
              // ê¸°ì¡´ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ëª¨ë‘ ì œê±°
              const newButton = playButton.cloneNode(true);
              playButton.parentNode.replaceChild(newButton, playButton);
              
              // ìƒˆ ë²„íŠ¼ì— ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
              newButton.addEventListener('click', () => {
                console.log('Play/Pause ë²„íŠ¼ í´ë¦­ë¨, í˜„ì¬ ìƒíƒœ:', playerState.isPlaying ? 'ì¬ìƒ ì¤‘' : 'ì¼ì‹œì •ì§€');
                
                if (playerState.isPlaying) {
                  widget.pause();
                } else {
                  widget.play();
                }
              });
            }
            
            // ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ 
            widget.bind(window.SC.Widget.Events.READY, () => {
              console.log('í”Œë ˆì´ì–´ ì¤€ë¹„ ì™„ë£Œ, ì¬ìƒ ì‹œì‘');
              
              // ì¬ìƒ ê¸¸ì´ ê°€ì ¸ì˜¤ê¸°
              widget.getDuration(function(d) {
                playerState.duration = d;
                console.log('íŠ¸ë™ ê¸¸ì´:', d);
                if (timeDisplay) {
                  timeDisplay.textContent = `0:00 / ${formatTime(d)}`;
                }
              });
              
              // í”„ë¡œê·¸ë ˆìŠ¤ë°” í´ë¦­ ì´ë²¤íŠ¸ (íƒìƒ‰)
              const progressContainer = document.querySelector('.progress-container');
              if (progressContainer) {
                // ê¸°ì¡´ ì´ë²¤íŠ¸ ì œê±°
                const newProgressContainer = progressContainer.cloneNode(true);
                progressContainer.parentNode.replaceChild(newProgressContainer, progressContainer);
                
                // ìƒˆ ì´ë²¤íŠ¸ ì¶”ê°€
                newProgressContainer.addEventListener('click', function(e) {
                  const rect = this.getBoundingClientRect();
                  const x = e.clientX - rect.left;
                  const clickPosition = x / rect.width;
                  
                  // í´ë¦­ ìœ„ì¹˜ë¡œ ì´ë™ (0-1 ì‚¬ì´ì˜ ìƒëŒ€ì  ìœ„ì¹˜)
                  if (playerState.duration > 0) {
                    const seekPosition = playerState.duration * clickPosition;
                    widget.seekTo(seekPosition);
                    console.log('ì‹œí¬ ìœ„ì¹˜:', seekPosition);
                    
                    // í”„ë¡œê·¸ë ˆìŠ¤ë°” UI ë°”ë¡œ ì—…ë°ì´íŠ¸
                    const newProgressBar = document.getElementById('progress-bar');
                    if (newProgressBar) {
                      const percent = (clickPosition * 100);
                      newProgressBar.style.width = `${percent}%`;
                    }
                    
                    const newTimeDisplay = document.getElementById('time-display');
                    if (newTimeDisplay) {
                      newTimeDisplay.textContent = `${formatTime(seekPosition)} / ${formatTime(playerState.duration)}`;
                    }
                  }
                });
              }
              
              widget.play();
            });
            
            widget.bind(window.SC.Widget.Events.PLAY, () => {
              console.log('ì¬ìƒ ì‹œì‘ë¨');
              playerState.isPlaying = true;
              
              const currentStatusDot = document.getElementById('status-dot');
              if (currentStatusDot) {
                currentStatusDot.classList.add('playing');
              }
              
              // ì¬ìƒ ë²„íŠ¼ ì•„ì´ì½˜ ë³€ê²½
              const currentPlayButton = document.getElementById('player-play-btn');
              if (currentPlayButton) {
                currentPlayButton.innerHTML = '<svg viewBox="0 0 24 24"><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/></svg>';
              }
              
              // íƒ€ì´ë¨¸ í´ë¦¬ì–´
              if (this.positionInterval) {
                clearInterval(this.positionInterval);
              }
              
              // ìƒˆë¡œìš´ ì—…ë°ì´íŠ¸ íƒ€ì´ë¨¸ ì‹œì‘
              this.positionInterval = setInterval(function() {
                widget.getPosition(function(position) {
                  console.log('í˜„ì¬ ìœ„ì¹˜:', position, 'ì „ì²´ ê¸¸ì´:', playerState.duration);
                  const percent = (position / playerState.duration) * 100;
                  
                  const currentProgressBar = document.getElementById('progress-bar');
                  if (currentProgressBar) {
                    currentProgressBar.style.width = `${percent}%`;
                  }
                  
                  const currentTimeDisplay = document.getElementById('time-display');
                  if (currentTimeDisplay) {
                    currentTimeDisplay.textContent = `${formatTime(position)} / ${formatTime(playerState.duration)}`;
                  }
                });
              }, 500);
            });
            
            widget.bind(window.SC.Widget.Events.PAUSE, () => {
              console.log('ì¼ì‹œì •ì§€ë¨');
              playerState.isPlaying = false;
              
              const currentStatusDot = document.getElementById('status-dot');
              if (currentStatusDot) {
                currentStatusDot.classList.remove('playing');
              }
              
              // ì¬ìƒ ë²„íŠ¼ ì•„ì´ì½˜ ë³€ê²½
              const currentPlayButton = document.getElementById('player-play-btn');
              if (currentPlayButton) {
                currentPlayButton.innerHTML = '<svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>';
              }
              
              // íƒ€ì´ë¨¸ ì •ì§€
              if (this.positionInterval) {
                clearInterval(this.positionInterval);
              }
            });
            
            widget.bind(window.SC.Widget.Events.FINISH, () => {
              console.log('ì¬ìƒ ì™„ë£Œ');
              playerState.isPlaying = false;
              
              const currentStatusDot = document.getElementById('status-dot');
              if (currentStatusDot) {
                currentStatusDot.classList.remove('playing');
              }
              
              // ì¬ìƒ ë²„íŠ¼ ì•„ì´ì½˜ ë³€ê²½
              const currentPlayButton = document.getElementById('player-play-btn');
              if (currentPlayButton) {
                currentPlayButton.innerHTML = '<svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>';
              }
              
              // íƒ€ì´ë¨¸ ì •ì§€
              if (this.positionInterval) {
                clearInterval(this.positionInterval);
              }
              
              // í”„ë¡œê·¸ë ˆìŠ¤ë°” ì´ˆê¸°í™”
              const currentProgressBar = document.getElementById('progress-bar');
              if (currentProgressBar) {
                currentProgressBar.style.width = '0%';
              }
              
              const currentTimeDisplay = document.getElementById('time-display');
              if (currentTimeDisplay) {
                currentTimeDisplay.textContent = `0:00 / ${formatTime(playerState.duration)}`;
              }
            });
            
            return widget;
          } catch (error) {
            console.error('SoundCloud í”Œë ˆì´ì–´ ì´ˆê¸°í™” ì˜¤ë¥˜:', error);
            return null;
          }
        }
      };
    </script>
  </head>
  <body>
    <div class="container">
      <div id="debug-version">
        Chill Mix for Designers
      </div>
      
      <div class="header">
        <!-- SC MICRO title removed -->
      </div>

      <div class="theme-selector">
        <label for="theme-select" class="playlist-title">Themes</label>
        <select id="theme-select">
        </select>
      </div>

      <div class="playlist-container">
        <div class="playlist-title">Tracks</div>
        <div class="track-list" id="track-list">
        </div>
      </div>

      <div id="preview-container" class="empty" style="display: none">
        <div class="preview-player">
          <div class="preview-display">
            <div class="now-playing">
              <span style="text-align: left;">NOW PLAYING</span>
              <div class="status-dot" id="status-dot"></div>
            </div>
            <div class="preview-title" id="preview-title">Select a track</div>
            <div class="preview-artist" id="preview-artist">Choose from the list above</div>
            
            <!-- Custom player interface -->
            <div class="now-playing-container">
              <div class="player-controls">
                <button class="play-button" id="player-play-btn">
                  <svg viewBox="0 0 24 24">
                    <path d="M8 5v14l11-7z"/>
                  </svg>
                </button>
                <div class="progress-container">
                  <div class="progress-bar" id="progress-bar"></div>
                </div>
                <div class="time-display" id="time-display">0:00 / 0:00</div>
              </div>
            </div>
            
            <!-- SoundCloud iframe - hidden but still used for actual audio -->
            <iframe
              id="sc-iframe"
              class="preview-iframe"
              scrolling="no"
              frameborder="no"
              allow="autoplay"
              style="display: none;"
            ></iframe>
          </div>
        </div>
      </div>
      
      <div class="footer">
        &copy; 2025 UX Lab | Corporate Designer Center | LG Electronics
      </div>
    </div>
    
    <script>
      // í˜ì´ì§€ ë¡œë“œ í›„ DOM ìš”ì†Œ í™•ì¸ ë° UI ì´ˆê¸°í™”
      window.addEventListener('load', function() {
        console.log('í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ');
        
        setTimeout(function() {
          try {
            // Show preview container with empty state
            const previewContainer = document.getElementById('preview-container');
            if (previewContainer) {
              previewContainer.style.display = 'block';
            }
            
            // 1. DOM ìš”ì†Œ í™•ì¸
            console.log('DOM ìš”ì†Œ í™•ì¸:');
            const elements = window.debugFigmaPlugin.logDom();
            
            // 2. UI ìš”ì†Œê°€ ëª¨ë‘ ìˆëŠ”ì§€ í™•ì¸
            const allElementsExist = !Object.values(elements).includes(null);
            console.log('ëª¨ë“  DOM ìš”ì†Œ ì¡´ì¬: ' + (allElementsExist ? 'ì˜ˆ' : 'ì•„ë‹ˆì˜¤'));
            
            // 3. ë¬¸ì œê°€ ìˆì„ ê²½ìš° ë°±ì—… ì†”ë£¨ì…˜ ì‹¤í–‰
            if (!allElementsExist || !document.querySelector('#theme-select option')) {
              console.log('ì¼ë¶€ UI ìš”ì†Œê°€ ì—†ê±°ë‚˜ ì˜µì…˜ì´ ë¡œë“œë˜ì§€ ì•ŠìŒ. ì§ì ‘ ì´ˆê¸°í™” ì‹¤í–‰');
              
              // í…Œë§ˆì™€ íŠ¸ë™ ì§ì ‘ ì´ˆê¸°í™”
              const themesLoaded = window.debugFigmaPlugin.checkThemes();
              const tracksLoaded = window.debugFigmaPlugin.createTracks();
              
              if (themesLoaded) {
                console.log('í…Œë§ˆê°€ ì„±ê³µì ìœ¼ë¡œ ë¡œë“œë¨');
                
                // ê¸°ë³¸ í…Œë§ˆ ìŠ¤íƒ€ì¼ ì ìš©
                const themeSelect = document.getElementById('theme-select');
                if (themeSelect && themeSelect.options.length > 0) {
                  themeSelect.selectedIndex = 0; // Modern (Default) ì„ íƒ (ì¸ë±ìŠ¤ 0)
                  window.debugFigmaPlugin.applyTheme('framer-minimal'); // ì´ˆê¸° í…Œë§ˆ ì ìš©
                  
                  // í…Œë§ˆ ë³€ê²½ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì¶”ê°€
                  themeSelect.addEventListener('change', function() {
                    console.log('í…Œë§ˆ ì„ íƒ ë³€ê²½ë¨: ' + this.value);
                    window.debugFigmaPlugin.applyTheme(this.value);
                  });
                }
              }
              
              if (tracksLoaded) {
                console.log('íŠ¸ë™ì´ ì„±ê³µì ìœ¼ë¡œ ë¡œë“œë¨');
              }
              
              // SoundCloud API ë¡œë“œ
              window.debugFigmaPlugin.loadSoundCloudAPI();
              
              // ì´ˆê¸° í† ìŠ¤íŠ¸ ë©”ì‹œì§€
              setTimeout(() => {
                window.debugFigmaPlugin.showToast('âœ¨ ì¤€ë¹„ë¨');
              }, 1000);
            }
          } catch (error) {
            console.error('UI ì´ˆê¸°í™” ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
          }
        }, 1000);
      });
    </script>

    <script src="./dist/ui.js?v=1.3.1"></script>
  </body>
</html>